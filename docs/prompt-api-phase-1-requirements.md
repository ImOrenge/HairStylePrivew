# Prompt API Phase 1: 요구사항/범위 확정

기준 문서:
- `docs/prompt-generator.md`
- `hairPrivewPrd.md`
- `docs/HairFit_SaaS_Development_Plan.md`

## 목표
- 업로드된 사진 + 사용자 자유입력을 기반으로 이미지 생성 프롬프트를 만드는 API 요구사항을 확정한다.
- MVP 범위와 2차 범위를 분리해 개발/QA/운영 기준을 고정한다.

## 범위
- 포함:
1. 입력 데이터 정의 (`generationId`, `userInput`, 선택 옵션)
2. 출력 데이터 정의 (`prompt`, `negativePrompt`, `normalizedOptions`)
3. 인증/권한 요구사항 (Clerk 사용자 기준 본인 데이터만 접근)
4. 실패 응답 규칙 (400/401/403/404/422/500)

- 제외:
1. 멀티모달 고급 이미지 이해 모델 튜닝
2. 다국어 자동 번역 고도화
3. A/B 실험 시스템

## 기능 요구사항
1. 사용자는 업로드 완료 이후에만 프롬프트 생성 요청 가능
2. API는 `generationId` 소유권을 검증해야 함
3. 자유입력 문장을 구조화된 프롬프트로 변환해야 함
4. 부적절 입력(금칙어/유해표현)은 거부 또는 안전한 형태로 치환
5. 생성 결과는 이후 이미지 생성 API에서 그대로 사용 가능해야 함

## 비기능 요구사항
1. p95 응답 시간 3초 이내(LLM 호출 제외한 내부 처리)
2. 장애 시 재시도 가능한 에러 코드/메시지 반환
3. 프롬프트 버전 추적 가능 (`prompt_version`)
4. 로그에서 사용자 식별정보 최소화

## 완료 기준
1. 프론트/백엔드/QA가 동일한 요청/응답 포맷을 사용
2. API 에러 코드 표가 문서화됨
3. 유저 스토리 기반 시나리오(성공/실패) 정의 완료
